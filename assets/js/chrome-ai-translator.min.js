const openGoogleTranslatorAPIModel=(jQuery=>{const init=async()=>{const languageSupported=await langStatus();if("after-download"===languageSupported){const link=jQuery('<br><span>Install the language pack. <a href="https://developer.chrome.com/docs/ai/translator-api#bypass_language_restrictions_for_local_testing" target="_blank">Instructions here</a></span>');jQuery("#latlt_chromeAI_btn").after(link)}"readily"===languageSupported?(this.translateStatus=!1,this.completedTranslateIndex=0,jQuery(document).on("click","#latlt_chromeAI_btn",openStringsModal)):jQuery("#latlt_chromeAI_btn").attr("disabled",!0)},langStatus=async()=>{if(!("translation"in self&&"createTranslator"in self.translation))return console.error("The Translator API is not supported."),!1;const defaultLangCode=locoConf.conf.locale.lang||null;return this.defaultLang=mapLanguageCode(defaultLangCode),await translation.canTranslate({sourceLanguage:"en",targetLanguage:this.defaultLang})},openStringsModal=e=>{const modelContainer=jQuery("div#chrome-ai-translator-model.chrome-ai-translator-container");modelContainer.find(".latlt_actions > .latlt_save_strings").prop("disabled",!0),modelContainer.find(".latlt_stats").hide(),localStorage.setItem("lang",this.defaultLang),isLanguageSupported(this.defaultLang)?(jQuery("#latlt-dialog").dialog("close"),modelContainer.fadeIn("slow")):showUnsupportedLanguageMessage(modelContainer),this.translateBtn=jQuery(".chrome-ai-translator #chrome_ai_translator_element #chrome_ai_translator_btn"),this.translateBtn.off("click"),this.translateBtn.prop("disabled",!1),this.translateStatus?this.translateBtn.text("Continue Translation").on("click",()=>{stringTranslation(this.completedTranslateIndex+1)}):this.translateBtn.on("click",startTranslationProcess)},mapLanguageCode=code=>{const languageMap={bel:"be",he:"iw",snd:"sd",jv:"jw",nb:"no",nn:"no"};return languageMap[code]||code},isLanguageSupported=lang=>{const supportedLanguages=new Set(["af","jv","no","am","ar","az","ba","be","bg","bn","bs","ca","ceb","cs","cy","da","de","el","en","eo","es","et","eu","fa","fi","fr","ga","gd","gl","gu","he","hi","hr","ht","hu","hy","id","is","it","ja","jv","ka","kk","km","kn","ko","ky","la","lb","lo","lt","lv","mg","mhr","mi","mk","ml","mn","mr","mrj","ms","mt","my","ne","nl","no","pa","pap","pl","pt","ro","ru","si","sk","sl","sq","sr","su","sv","sw","ta","te","tg","th","tl","tr","tt","udm","uk","ur","uz","vi","xh","yi","zh"]);return supportedLanguages.has(lang)},showUnsupportedLanguageMessage=modelContainer=>{jQuery("#latlt-dialog").dialog("close"),modelContainer.find(".notice-container").addClass("notice inline notice-warning").html("Chrome AI Translator does not support this language."),modelContainer.find(".latlt_string_container, .choose-lang, .latlt_save_strings, #ytWidget, .translator-widget, .notice-info, .is-dismissible").hide(),modelContainer.fadeIn("slow")},startTranslationProcess=async()=>{const langCode=this.defaultLang;this.translateStatus=!0,this.translateStringEle=jQuery("#chrome-ai-translator-model .chrome-ai-translator-body table tbody tr td.target.translate"),this.stringContainer=jQuery("#chrome-ai-translator-model .modal-content .latlt_string_container"),this.translator=await self.translation.createTranslator({sourceLanguage:"en",targetLanguage:langCode}),this.translateStringEle.length>0&&await stringTranslation(this.completedTranslateIndex)},scrollStringContainer=position=>{this.stringContainer.scrollTop(position)},stringTranslation=async index=>{const stringContainer=this.stringContainer,stringContainerPosition=stringContainer[0].getBoundingClientRect();this.completedTranslateIndex=index;const ele=this.translateStringEle[index],eleTopPosition=ele.closest("tr").offsetTop,containerHeight=stringContainer.height();eleTopPosition>containerHeight+stringContainerPosition.y&&scrollStringContainer(eleTopPosition-containerHeight+ele.offsetHeight);const originalString=ele.innerText,translatedString=await this.translator.translate(originalString);ele.innerText=translatedString,this.translateStringEle.length>index+1&&stringContainer[0].scrollHeight>100?(jQuery("#chrome-ai-translator-model .latlt_translate_progress").fadeIn("slow"),await stringTranslation(this.completedTranslateIndex+1)):(this.translateBtn.prop("disabled",!0),jQuery("#chrome-ai-translator-model .latlt_save_strings").prop("disabled",!1),jQuery("#chrome-ai-translator-model .latlt_translate_progress").fadeOut("slow"),jQuery("#chrome-ai-translator-model .latlt_stats").fadeIn("slow"))};jQuery(document).ready(init)})(jQuery);